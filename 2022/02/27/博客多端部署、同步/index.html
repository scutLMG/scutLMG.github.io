<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>博客多端部署、同步 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="hexo 自带的提交 hexo -d 提交的是博客生成的 html 文件，如果需要多端同步，需要源码一并提交。使用 Git 进行上传、拉取、同步管理。了解了一下大致有两种做法，一种是将源码上传到原来的 github 网页博客项目的新分支，这样意味着所有源文件都公开，虽然也没啥，但是就是不太爽。另一种就是创建新的私有库，存储源代码，写博客、发布博客前，先拉取，后上传即可。">
<meta property="og:type" content="article">
<meta property="og:title" content="博客多端部署、同步">
<meta property="og:url" content="http://example.com/2022/02/27/%E5%8D%9A%E5%AE%A2%E5%A4%9A%E7%AB%AF%E9%83%A8%E7%BD%B2%E3%80%81%E5%90%8C%E6%AD%A5/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="hexo 自带的提交 hexo -d 提交的是博客生成的 html 文件，如果需要多端同步，需要源码一并提交。使用 Git 进行上传、拉取、同步管理。了解了一下大致有两种做法，一种是将源码上传到原来的 github 网页博客项目的新分支，这样意味着所有源文件都公开，虽然也没啥，但是就是不太爽。另一种就是创建新的私有库，存储源代码，写博客、发布博客前，先拉取，后上传即可。">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-02-27T00:00:00.000Z">
<meta property="article:modified_time" content="2023-02-23T18:16:26.615Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="blog">
<meta name="twitter:card" content="summary">
  
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-博客多端部署、同步" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/02/27/%E5%8D%9A%E5%AE%A2%E5%A4%9A%E7%AB%AF%E9%83%A8%E7%BD%B2%E3%80%81%E5%90%8C%E6%AD%A5/" class="article-date">
  <time datetime="2022-02-27T00:00:00.000Z" itemprop="datePublished">2022-02-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/blog/">blog</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      博客多端部署、同步
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>hexo 自带的提交 <code>hexo -d</code> 提交的是博客生成的 html 文件，如果需要多端同步，需要源码一并提交。使用 Git 进行上传、拉取、同步管理。了解了一下大致有两种做法，一种是将源码上传到原来的 <code>github</code> 网页博客项目的新分支，这样意味着所有源文件都公开，虽然也没啥，但是就是不太爽。另一种就是创建新的私有库，存储源代码，写博客、发布博客前，先拉取，后上传即可。</p>
<span id="more"></span>

<h2 id="本地部署"><a href="#本地部署" class="headerlink" title="本地部署"></a>本地部署</h2><p>要在不同终端部署博客，需要建立相似的版本环境。</p>
<h3 id="安装指定版本的nodejs"><a href="#安装指定版本的nodejs" class="headerlink" title="安装指定版本的nodejs"></a>安装指定版本的nodejs</h3><p>指定版本源，指定为14版本</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl -sL https://deb.nodesource.com/setup_14.x | sudo -E bash -</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install nodejs</span><br><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure>

<h3 id="安装git"><a href="#安装git" class="headerlink" title="安装git"></a>安装git</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install git-all</span><br><span class="line">git --version</span><br></pre></td></tr></table></figure>

<h3 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo@5.4.0</span><br><span class="line">npm install hexo@legacy</span><br><span class="line">npm i hexo-cli -g</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装指定版本</span></span><br><span class="line">npm install hexo@4</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装某版本的最新包</span></span><br><span class="line">npm view &lt;package_name&gt; version</span><br><span class="line">npm info &lt;package_name&gt;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看包的最新版本信息</span></span><br><span class="line">npm list</span><br><span class="line">npm list &lt;package_name&gt;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">列出已安装包/列出指定包的版本信息</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装完毕后</span></span><br><span class="line">hexo -v           </span><br></pre></td></tr></table></figure>

<h3 id="安装必要的依赖包"><a href="#安装必要的依赖包" class="headerlink" title="安装必要的依赖包"></a>安装必要的依赖包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install npm-check-updates -g	#检查包更新</span><br><span class="line">npm install @octokit/rest			#评论插件</span><br><span class="line">npm install hexo-theme-icarus		#主题文件</span><br></pre></td></tr></table></figure>



<h2 id="同步"><a href="#同步" class="headerlink" title="同步"></a>同步</h2><h3 id="创建私有仓库"><a href="#创建私有仓库" class="headerlink" title="创建私有仓库"></a>创建私有仓库</h3><p>github 上创建私有仓库</p>
<h3 id="初始源上传github"><a href="#初始源上传github" class="headerlink" title="初始源上传github"></a>初始源上传github</h3><p>编写 <code>.gitignore</code> ，没有就创建一个，用于忽略指定文件不同步。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/.deploy_git</span><br><span class="line">/public</span><br><span class="line">/node_modules</span><br><span class="line"><span class="comment">/*.log</span></span><br><span class="line"><span class="comment">db.json</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">git remote add origin git@github.com:your_name/repo_name.git</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">连接到远程仓库，别名origin</span></span><br><span class="line">git remote -v</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看连接</span></span><br><span class="line">git pull origin main --allow-unrelated-histories</span><br><span class="line">git add -A</span><br><span class="line">git commit -m &quot;blogsource&quot;</span><br><span class="line">git push</span><br><span class="line">git push --set-upstream origin main</span><br></pre></td></tr></table></figure>



<h3 id="合并分支"><a href="#合并分支" class="headerlink" title="合并分支"></a>合并分支</h3><p>因为 github 将原本默认的 master 分支更改为 main 。所以有的旧仓库需要合并分支。不想合并其实只需要将  master 重新改为默认分支就好，不过这样新旧项目的默认主分支就不同了，有点麻烦。</p>
<ul>
<li><p>克隆仓库</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone repo_name.git</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建 main 并推送</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b main</span><br><span class="line">git push origin main</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除本地、远端 master</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git branch -d master</span><br><span class="line">git push oringin master</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="拉取代码"><a href="#拉取代码" class="headerlink" title="拉取代码"></a>拉取代码</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull origin main</span><br></pre></td></tr></table></figure>





<h3 id="多端同步"><a href="#多端同步" class="headerlink" title="多端同步"></a>多端同步</h3><p>初始化密钥。如果有多个帐号的需求，请不要使用全局配置。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;yourGithubName&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;yourGithubEmail&quot;</span></span><br><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;yourGithubEmail&quot;</span></span><br><span class="line"><span class="comment">#然后查看密钥，复制到github个人帐号，创建新的settings/SSH Keys</span></span><br><span class="line"><span class="built_in">cat</span> ~/.ssh/id_rsa.pub</span><br><span class="line"><span class="comment">#测试</span></span><br><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure>

<p>然后</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">git remote add origin githubUserName/repoName.git</span><br><span class="line">git <span class="built_in">clone</span> git@github.com:githubUserName/repoName.git</span><br></pre></td></tr></table></figure>

<p>回到目录下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>

<p>报错就重开终端，文件夹数据、属性没刷新。</p>
<p>至此，完成多端的同步设置。使用 <code>git pull</code> 查看，最新。</p>
<h2 id="日常使用"><a href="#日常使用" class="headerlink" title="日常使用"></a>日常使用</h2><p>上传、写博客</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git pull</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;sync&quot;</span><br><span class="line">git push origin main</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hexo g -d？</span></span><br></pre></td></tr></table></figure>



<h3 id="维护"><a href="#维护" class="headerlink" title="维护"></a>维护</h3><p>博客还是需要时不时维护一下的，特别是那帮搞前端的天天升级依赖包，哪天哪个依赖包升级了，就开始疯狂报错了。一年多没有维护的博客可以说是基于bug运行了。<del>（我更新依赖把博客滚挂了）</del></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install npm-check-updates -g</span><br><span class="line">ncu</span><br><span class="line">ncu -u			#升级依赖包</span><br><span class="line">npm audit fix	#修复依赖包安全漏洞</span><br></pre></td></tr></table></figure>



<h2 id="github-action自动部署"><a href="#github-action自动部署" class="headerlink" title="github action自动部署"></a>github action自动部署</h2><p>另见笔记：GitHub Action入门指南—实战-自动部署小节。</p>
<p>每次写完，不仅要 push ，还要 hexo g -d ，确实是不太优雅，自动部署配置好 Action 之后，每次 push 完就可以溜了，好多了。</p>
<h2 id="关键文件备份"><a href="#关键文件备份" class="headerlink" title="关键文件备份"></a>关键文件备份</h2><p><code>hexo</code> 以及各种主题，都是博客的载体罢了，不管博客服务有没有正常运行，有没崩溃，都有需要备份的数据，便以归档、重建。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a target="_blank" rel="noopener" href="https://sharifxu.top/2020/05/14/Hexo-Mutiagent-Manager/"><code>Hexo</code> 博客多终端同步管理</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/nineya_com/article/details/103535192"><code>Hexo</code> 多终端同步和管理</a></p>
<p><a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/asset-folders"><code>Hexo</code> 官方文档-资源文件夹</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/02/27/%E5%8D%9A%E5%AE%A2%E5%A4%9A%E7%AB%AF%E9%83%A8%E7%BD%B2%E3%80%81%E5%90%8C%E6%AD%A5/" data-id="clehfej2n003abpnb6hiqe6dv" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/blog/" rel="tag">blog</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/03/03/Github%20Action%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          GitHub Action入门指南
        
      </div>
    </a>
  
  
    <a href="/2022/01/13/%E5%88%B7%E6%96%B0.gitignore/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">刷新.gitignore</div>
    </a>
  
</nav>

  
</article>

</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2023 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>